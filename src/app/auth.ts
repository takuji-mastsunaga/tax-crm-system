/* eslint-disable @typescript-eslint/no-explicit-any */ import NextAuth from "next-auth"; import GoogleProvider from "next-auth/providers/google"; export const { handlers, signIn, signOut, auth } = NextAuth({ providers: [ GoogleProvider({ clientId: process.env.GOOGLE_CLIENT_ID!, clientSecret: process.env.GOOGLE_CLIENT_SECRET!, authorization: { params: { scope: "openid email profile", hd: "your-company.com" } } }) ], callbacks: { async signIn({ user }: any) { if (user.email && user.email.endsWith("@your-company.com")) { return true; } return false; }, async jwt({ token, user }: any) { if (user) { token.uid = user.id; } return token; }, async session({ session, token }: any) { if (session.user) { session.user.id = token.uid as string; } return session; } }, pages: { signIn: "/auth/signin", error: "/auth/error" } });
